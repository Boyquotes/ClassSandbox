[gd_scene load_steps=6 format=2]

[ext_resource path="res://scripts/Character.gd" type="Script" id=1]
[ext_resource path="res://scripts/MovementController.gd" type="Script" id=2]
[ext_resource path="res://scripts/CameraController.gd" type="Script" id=3]
[ext_resource path="res://PlayerStats.tscn" type="PackedScene" id=4]

[sub_resource type="CylinderShape" id=1]
height = 1.5
radius = 0.6

[node name="Player" type="Spatial"]
script = ExtResource( 2 )
receiver = NodePath("CharacterBody")

[node name="CameraRoot" type="Spatial" parent="."]
script = ExtResource( 3 )
follow_target = NodePath("../CharacterBody/FollowTarget")
character_path = NodePath("../CharacterBody")

[node name="Tween" type="Tween" parent="CameraRoot"]

[node name="FirstPersonCamera" type="Camera" parent="CameraRoot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.25, 0 )
current = true

[node name="ThirdPersonCamera" type="Camera" parent="CameraRoot"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.25, 5 )
current = true

[node name="CharacterBody" type="KinematicBody" parent="."]
script = ExtResource( 1 )

[node name="Tween" type="Tween" parent="CharacterBody"]

[node name="Collider" type="CollisionShape" parent="CharacterBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.75, 0 )
shape = SubResource( 1 )

[node name="FollowTarget" type="Spatial" parent="CharacterBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0 )

[node name="Avatar" type="CSGCylinder" parent="CharacterBody"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 0.5, 0, 0.75, 0 )
radius = 0.6
height = 1.5

[node name="CSGSphere" type="CSGSphere" parent="CharacterBody/Avatar"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, -0.5 )
radius = 0.2

[node name="PlayerStats" parent="." instance=ExtResource( 4 )]

[node name="Stamina" parent="PlayerStats" index="1"]
fill_rate = 10
drain_rate = 15

[connection signal="sprinted" from="CharacterBody" to="PlayerStats/Stamina" method="on_drain"]
[connection signal="emptied" from="PlayerStats/Health" to="CharacterBody" method="on_jump"]
[connection signal="filled" from="PlayerStats/Health" to="CharacterBody" method="on_jump"]
[connection signal="emptied" from="PlayerStats/Stamina" to="CharacterBody" method="on_sprint" binds= [ true ]]
[connection signal="filled" from="PlayerStats/Stamina" to="CharacterBody" method="on_jump"]

[editable path="PlayerStats"]
